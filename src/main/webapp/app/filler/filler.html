<div ng-cloak id="filler-content">

    <md-list id="filler-list">
        <md-button class="md-raised md-primary" aria-label="Add Game" ng-click="addGameModal()">
            <md-icon md-font-library="material-icons" >add</md-icon>
            add Game
        </md-button>

        <md-list-item class="md-3-line" ng-repeat="(key, game) in games track by key" ng-click="selectGame(key)" >
            <p>
                Game {{key}}<br/>
                {{game.dateCreated  | date:'short'}}
            </p>
            <md-divider></md-divider>
        </md-list-item>
    </md-list>

    <md-card id="game-content">
        <md-card-title>
            <md-card-title-text>
                <span class="md-headline">Game {{currentIdGame}}</span>
            </md-card-title-text>
        </md-card-title>
        <md-card-content layout="row" layout-align="space-between">
            <div class="card-media">
                <table id="filler-table-grid">
                    <tr ng-repeat="line in currentGame.grid.grid" ng-init="x = $index; last = currentGame.grid.grid.length - 1">
                        <td ng-repeat="cell in line" ng-style="{'background-color': getColor(cell.color)}" ng-init="y = $index">
                            <span ng-if="x == 0 && y == 0 && currentGame.players.length > 0">1</span>
                            <span ng-else-if="x == last && y == last && currentGame.players.length > 1">2</span>
                            <span ng-else-if="x == 0 && y == last && currentGame.players.length > 2">3</span>
                            <span ng-else-if="x == last && y == 0 && currentGame.players.length > 3">4</span>
                            <span ng-else-if="displayCharColor">{{cell.color}}</span>
                            <span ng-else>&nbsp;&nbsp;&nbsp;</span>
                        </td>
                    </tr>
                </table>
                <div class="spacer" style="clear: both;"></div>
            </div>
            <md-card-actions layout="column">
                <md-button class="md-icon-button" aria-label="Delete">
                    <md-icon md-font-library="material-icons" ng-click="showConfirmDelete()">delete</md-icon>
                </md-button>
                <md-button class="md-icon-button" aria-label="Start" ng-click="startGame(currentIdGame)">
                    <i class="material-icons" ng-style="{'color' : currentGame.started ? 'green' : ''}">play_circle_filled</i>
                </md-button>
                <md-button class="md-icon-button" aria-label="Start" ng-click="displayCharColor = !displayCharColor" ng-init="displayCharColor = true">
                    <i class="material-icons">invert_colors</i>
                </md-button>

            </md-card-actions>
        </md-card-content>
        <md-card-content>
            <u>{{currentGame.players.length}} Players :</u>
            {{currentGame.started ? "" : "Game has not started"}}
            {{currentGame.started && !currentGame.finished ? "Game is in progress" : ""}}
            {{currentGame.finished ? "Game has finished" : ""}}
            | Round {{currentGame.round}} |
            Turn of Player {{currentGame.currentIdPlayerTurn + 1}} <br/>
            <div ng-repeat="player in currentGame.players"  ng-init="idPlayerTurn = $index">
                <span ng-style="{'background-color': getColor(player.playerColor)}">
                    Player {{$index + 1}} : {{player.playerColor}}
                </span>, init position: {{player.initPosition}}

                <span ng-if="isCurrentPlayer(currentIdGame, idPlayerTurn)">
                    <i class="material-icons">person</i>
                    <span ng-if="isPlayerTurn(currentGame, idPlayerTurn)">
                        It's your turn, choose color:
                        <table>
                            <tr>
                                <td ng-repeat="(key,color) in mapColor"
                                    ng-style="{'background-color' : color}" class="filler-cell"
                                    ng-click="sendMove(key, currentIdGame, idPlayerTurn)"> {{key}} </td>
                            </tr>
                        </table>
                    </span>
                </span>
                ({{countPoints(currentGame, currentGame.players[idPlayerTurn].playerColor)}} Points)
            </div>
            <br/>
            <md-button ng-if="!currentGame.started" class="md-raised md-primary" aria-label="Add Game" ng-click="addPlayer(currentIdGame)">
                <i class="material-icons" >person_add</i>
                Add player
            </md-button>
            <md-button ng-if="!currentGame.started" class="md-raised md-primary" aria-label="Start Game" ng-click="startGame(currentIdGame)">
                <md-icon class="material-icons" >play_circle_filled</md-icon>
                Star Game
            </md-button>
        </md-card-content>
    </md-card>

    <div class="spacer" style="clear: both;"></div>
</div>
